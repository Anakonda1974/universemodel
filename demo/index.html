<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Universe Model Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white p-6 font-sans">
  <div class="bg-orange-600 text-black text-3xl font-bold px-6 py-4 rounded-r-full mb-6 w-fit">Universe Model Demo</div>
  <div id="output" class="space-y-2"></div>

  <script type="module">
    import { SeedManager } from '../dist/SeedManager.js';
    import { PropertyGraph } from '../dist/PropertyGraph.js';
    import { ProceduralEntity } from '../dist/ProceduralEntity.js';
    import { createPlanetDefinitions } from '../dist/PlanetDefinitions.js';

    const seedManager = new SeedManager('DemoSeed42');
    const graph = new PropertyGraph(createPlanetDefinitions());
    const planet = new ProceduralEntity('Planet-X', ['MilkyWay','System-4','Planet-X'], seedManager, graph);
console.log('Planet Entity:', planet);
    const groups = planet.generateGrouped();
    const trace = planet.generateTrace();
    const container = document.getElementById('output');
    const rowMap = new Map();

    for (const [group, props] of Object.entries(groups)) {
      const header = document.createElement('div');
      header.className = 'text-xl mt-4 mb-2 underline';
      header.textContent = group;
      container.appendChild(header);
      for (const [key, value] of Object.entries(props)) {
        const row = document.createElement('div');
        row.className = 'flex justify-between bg-purple-600 text-black px-4 py-2 rounded-r-full cursor-pointer';
        row.innerHTML = `<span class="font-mono pr-4">${key}</span><span class="flex-1 text-right">${value}</span>`;
        row.addEventListener('click', () => {
          document.querySelectorAll('.highlight').forEach(el => el.classList.remove('ring-2','ring-yellow-400','highlight'));
          row.classList.add('ring-2','ring-yellow-400','highlight');
          const inputs = trace[key]?.inputs || {};
          Object.keys(inputs).forEach(inp => {
            const el = rowMap.get(inp);
            if (el) el.classList.add('ring-2','ring-yellow-400','highlight');
          });
        });
        rowMap.set(key, row);
        container.appendChild(row);
      }
    }
  </script>
</body>
</html>
